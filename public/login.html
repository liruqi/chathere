<!DOCTYPE html>
<html ng-app>
<head>
        <meta charset="UTF-8">
        <title>用户登录</title>
        <script type="text/javascript" src="/js/angular.js"></script>
</head>
<body ng-controller = "loginController">
<div id="login" >
  <ul>
          <li>
                  <label for="">邮箱</label>
                  <input type="input" ng-module="user.email">
          </li>
          <li>
                  <label for="">密码</label>
                  <input type="password" ng-module="user.password">
          </li>
          <li>
                  <input type="submit" value="登录" ng-click="doLogin()">
          </li>
                  <label ng-module="message" >{{message}}</label>
  </ul>
</div>
<script type="text/javascript">
var loginController=function($scope,$http,$window){
    $scope.doLogin=function(){
        var p=$http({method:'POST',url:'/userlogin',data:$scope.user});
        p.success(function(response){
            localStorage.user=JSON.stringify(response);
            if (localStorage.user.code == 0) {
                $scope.message = "登陆成功";
                $window.location.href='/room.html';
            }
            else 
                $scope.message = "登陆失败";
        });
    };
};
</script>
</body>
</html>
